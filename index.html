<!doctype html>
<html lang="en">

<head>
    <title>Text Block Planner</title>
    <link rel="icon" type="image/png" href="images/textBlockIcon_small.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css2?family=Amatic+SC&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/site.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <script src="scripts/navScript.js" defer></script>
    <script type="module" src="./modules/converters.mjs"></script>



    <script type="module">
        import { getFontList } from './scripts/pickFont.js';
        import { TextBlock, textMeasure, addChildTextDiv, removeChildTextDiv } from './modules/TextBlock.mjs';
        import { linearConverter, weightConverter } from './modules/converters.mjs';
        import { FileHandler, handleFilesIn, showFilesFromLocal, activateFile } from './modules/FileHandler.mjs';


        window.addEventListener("DOMContentLoaded", () => {

            //TESTING
            localStorage.clear();

            //TESTING
            /*
            * fetch default configuration json file for TextBlock settings
            */
            const textBlock1 = new TextBlock();

            const path = './json/defaults.json';
            const getJSONconfig = async function getJSONconfig(path) {
                const response = await fetch(path);
                const jsonData = await response.json();
                console.log("JSON fetched");
                console.log(jsonData);
                return jsonData;
            }

            /*
            * set TextBlock atributes to configuration json file for TextBlock settings
            */
            const setJSONconfig = function setJSONconfig(textBlock, jsonData) {
                textBlock.linearUnit = jsonData.linearUnit;
                textBlock.weightUnit = jsonData.weightUnit;
                textBlock.pageWidth = jsonData.pageWidth;
                textBlock.pageHeight = jsonData.pageHeight;
                textBlock.paperGSM = jsonData.paperGSM;
                textBlock.topBottomMargin = jsonData.topBottomMargin;
                textBlock.insideMargin = jsonData.insideMargin;
                textBlock.outsideMargin = jsonData.outsideMargin;
                textBlock.targetFontPt = jsonData.targetFontPt;
                textBlock.fontFamily = jsonData.fontFamily;
                textBlock.lineSpacing = jsonData.lineSpacing;
                textBlock.paragraphSpacing = jsonData.paragraphSpacing;
                textBlock.flyLeaves = jsonData.flyLeaves;
                textBlock.titlePage = jsonData.titlePage;
                textBlock.tableOfContentsPage = jsonData.tableOfContentsPage;
                textBlock.infoPage = jsonData.infoPage;
                textBlock.pagePerSectionHead = jsonData.pagePerSectionHead;
                textBlock.imagePages = jsonData.imagePages;
            }

            /*
            * set element values to match TextBlock settings
            */
            const setViewToConfig = function setViewToConfig(textBlock) {
                //Linear Unit
                document.querySelectorAll('input[name="pageLinearUnit"]').forEach((element) => {
                    if (element.value === textBlock.linearUnit) {
                        console.log(`match LU __ ${element.value} is ${textBlock.linearUnit}`);
                        //element.setAttribute("checked", "true");
                        document.getElementById(`${element.id}`).checked = true
                    }
                });
                //Weight Unit
                document.querySelectorAll('input[name="pageWeightUnit"]').forEach((element) => {
                    if (element.value === textBlock.weightUnit) {
                        console.log(`match LU __ ${element.value} is ${textBlock.weightUnit}`);
                        //element.setAttribute("checked", "true");
                        document.getElementById(`${element.id}`).checked = true
                    }
                });
                //Page Width
                document.querySelector('#widthInput').setAttribute("placeholder", textBlock.pageWidth);
                document.querySelector('#widthInput').value = null;
                //Page Height
                document.querySelector('#heightInput').setAttribute("placeholder", textBlock.pageHeight);
                document.querySelector('#heightInput').value = null;
                //Paper GSM
                document.querySelector('#paperWeight').setAttribute("placeholder", textBlock.paperGSM);
                document.querySelector('#paperWeight').value = null;
                //Top and Bottom Margins
                document.querySelector('#topBotomInput').setAttribute("placeholder", textBlock.topBottomMargin);
                document.querySelector('#topBotomInput').value = null;
                //Inside Margin
                document.querySelector('#insideInput').setAttribute("placeholder", textBlock.insideMargin);
                document.querySelector('#insideInput').value = null;
                //Outside Margin
                document.querySelector('#outsideInput').setAttribute("placeholder", textBlock.outsideMargin);
                document.querySelector('#outsideInput').value = null;
                //Target Font Point Size
                document.querySelector('#pointSizeFont').setAttribute("placeholder", textBlock.targetFontPt);
                document.querySelector('#pointSizeFont').value = null;
                //Font Family
                document.querySelector('#fontList').setAttribute("placeholder", textBlock.fontFamily);
                document.querySelector('#fontList').value = null;
                //Line Spacing
                document.querySelector('#lineSpacing').setAttribute("placeholder", textBlock.lineSpacing);
                document.querySelector('#lineSpacing').value = null;
                //Paragraph Spacing
                document.querySelector('#paragraphSpacing').setAttribute("placeholder", textBlock.paragraphSpacing);
                document.querySelector('#paragraphSpacing').value = null;
                //Fly Leaves
                document.querySelector('#numFlyLeaves').setAttribute("placeholder", textBlock.flyLeaves);
                document.querySelector('#numFlyLeaves').value = null;
                //Title Page
                if (textBlock.titlePage > 0) {
                    //document.querySelector('#titlePageAdd').setAttribute("checked", "true");
                    document.querySelector('#titlePageAdd').checked = true;
                } else {
                    //document.querySelector('#titlePageAdd').setAttribute("checked", "false");
                    document.querySelector('#titlePageAdd').checked = false;
                }
                //Table Of Contents Page
                if (textBlock.tableOfContentsPage > 0) {
                    //document.querySelector('#tocPageAdd').setAttribute("checked", "true");
                    document.querySelector('#tocPageAdd').checked = true;
                } else {
                    //document.querySelector('#tocPageAdd').setAttribute("checked", "false");
                    document.querySelector('#tocPageAdd').checked = false;
                }
                //Info Page
                if (textBlock.infoPage > 0) {
                    //document.querySelector('#bookInfoPageAdd').setAttribute("checked", "true");
                    document.querySelector('#bookInfoPageAdd').checked = true;
                } else {
                    //document.querySelector('#bookInfoPageAdd').setAttribute("checked", "false");
                    document.querySelector('#bookInfoPageAdd').checked = false;
                }
                //Page Per Section Head
                document.querySelector('#chHeadPage').setAttribute("placeholder", textBlock.pagePerSectionHead);
                document.querySelector('#chHeadPage').value = null;
                //Image Pages
                document.querySelector('#imagePage').setAttribute("placeholder", textBlock.imagePages);
                document.querySelector('#imagePage').value = null;


            }

            getJSONconfig(path).then(res => setJSONconfig(textBlock1, res)).then(re => setViewToConfig(textBlock1));

            /*
            * Text Block object
            */
            //const textBlock1 = new TextBlock();
            console.log("NEW TEXTBLOCK __");
            console.log(textBlock1);

            const numPageRes = document.getElementById("resultNumPages");
            const numSheetsRes = document.getElementById("resultNumSheets");
            const thicknessBlockRes = document.getElementById("resultBlockThickness");
            const weightBlockRes = document.getElementById("resultWeight");
            const noShowDiv = document.getElementById("textNoShow");

            /*
            * update results. WITH TEXTBLOCK
            */
            const updateResults = function () {
                if (isNaN(textBlock1.resultNumPages)) {
                    numPageRes.innerHTML = "&nbsp;";
                } else {
                    numPageRes.innerText = textBlock1.resultNumPages;
                }
                
                if (isNaN(textBlock1.resultNumSheets)){
                    numSheetsRes.innerHTML = "&nbsp;";
                } else {
                    numSheetsRes.innerText = textBlock1.resultNumSheets;
                }
                
                let showThickness = linearConverter((textBlock1.resultThickness), "cm", textBlock1.linearUnit);
                if (isNaN(showThickness)) {
                    //console.log("show thickness NaN");
                    showThickness = "";
                    thicknessBlockRes.innerText = showThickness + textBlock1.linearUnit;
                } else {
                    thicknessBlockRes.innerText = showThickness.toFixed(2) + textBlock1.linearUnit;
                }
                
                let showWeight = weightConverter(textBlock1.resultWeight, "kg", textBlock1.weightUnit);
                if (isNaN(showWeight)) {
                    showWeight = "";
                    weightBlockRes.innerText = showWeight + textBlock1.weightUnit;
                } else {
                    weightBlockRes.innerText = showWeight.toFixed(2) + textBlock1.weightUnit;
                }
            }

            /*
            * update linear measures from user. WITH TEXTBLOCK
            */
            const updateMeasures = function () {
                let inWidth = parseFloat(pageWidthIn.value);
                textBlock1.pageWidth = linearConverter(inWidth, textBlock1.linearUnit, "px");
                let inHeight = parseFloat(pageHeightIn.value);
                textBlock1.pageHeight = linearConverter(inHeight, textBlock1.linearUnit, "px");

                let valueTBM;
                if (topBottomMarginIn.value === "") {
                    valueTBM = 0;
                } else {

                    //TEST
                    /*                     console.log("TBM in__");
                                        console.log(topBottomMarginIn.value); */

                    valueTBM = parseFloat(topBottomMarginIn.value);
                }
                let inMarginTBM = valueTBM
                textBlock1.topBottomMargin = linearConverter(inMarginTBM, textBlock1.linearUnit, "px");

                let valueIM;
                if (insideMarginIn.value === "") {
                    valueIM = 0;
                } else {

                    //TEST
                    /*                     console.log("IM in__");
                                        console.log(insideMarginIn.value); */

                    valueIM = parseFloat(insideMarginIn.value);
                }
                let inMarginIM = valueIM;
                textBlock1.insideMargin = linearConverter(inMarginIM, textBlock1.linearUnit, "px");


                let valueOM;
                if (ousideMarginIn.value === "") {
                    valueOM = 0;
                } else {

                    //TEST
                    /*                     console.log("OM in__");
                                        console.log(ousideMarginIn.value); */

                    valueOM = parseFloat(ousideMarginIn.value);
                }
                let inMarginOM = valueOM;
                textBlock1.outsideMargin = linearConverter(inMarginOM, textBlock1.linearUnit, "px");
            }

            /*
            * button to reset textblock settings to default. WITH TEXTBLOCK
            */
            const defaultBtn = document.getElementById("defaultBtn");
            document.querySelector('#defaultBtn').addEventListener("click", event => {
                event.preventDefault();
                getJSONconfig(path)
                .then(res => setJSONconfig(textBlock1, res))
                .then(re => setViewToConfig(textBlock1))
                .then(res => updateMeasures())
                .then(res => textMeasure(noShowDiv, textBlock1))
                .then(res => updateResults());
            })


            /*
            * take in linear unit from user. WITH TEXTBLOCK
            */
            const linearUnitIn = document.getElementsByName("pageLinearUnit");
            document.querySelectorAll('input[name="pageLinearUnit"]').forEach((element) => {
                element.addEventListener("change", event => {
                    if (element.checked) {
                        textBlock1.linearUnit = element.value;

                        //TEST
                        /*                         console.log("L unit __");
                                                console.log(textBlock1.linearUnit); */
                    }
                    updateMeasures();
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                })
            })


            /*
            * take in weight unit from user. WITH TEXTBLOCK
            */
            const weightUnitIn = document.getElementsByName("pageWeightUnit");
            document.querySelectorAll('input[name="pageWeightUnit"]').forEach((element) => {
                element.addEventListener("change", event => {
                    if (element.checked) {
                        textBlock1.weightUnit = element.value;

                        //TEST
                        /*                         console.log("W unit __");
                                                console.log(textBlock1.weightUnit); */
                    }
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                })
            })


            /*
            * take in page width from user in px. WITH TEXTBLOCK
            */
            const pageWidthIn = document.getElementById("widthInput");
            document.querySelector('#widthInput').addEventListener("change", event => {
                let inWidth = parseFloat(pageWidthIn.value);
                if (inWidth >= 1) {
                    textBlock1.pageWidth = linearConverter(inWidth, textBlock1.linearUnit, "px");
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${inWidth} is not a valid value. Please try again.`);
                    pageWidthIn.value = null;
                }

            })

            /*
            * take in page height from user in px. WITH TEXTBLOCK
            */
            const pageHeightIn = document.getElementById("heightInput");
            document.querySelector('#heightInput').addEventListener("change", event => {
                let inHeight = parseFloat(pageHeightIn.value);
                if (inHeight >= 1) {
                    textBlock1.pageHeight = linearConverter(inHeight, textBlock1.linearUnit, "px");
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${inHeight} is not a valid value. Please try again.`);
                    pageHeightIn.value = null;
                }

            })


            /*
            * take in paper weight from user in GSM.  WITH TEXTBLOCK
            */
            const paperGSMinput = document.getElementById("paperWeight");
            document.querySelector('#paperWeight').addEventListener("change", event => {
                let value;
                if (paperGSMinput.value === "") {
                    value = 75;
                } else {
                    //TEST
                    /*                     console.log("GSM __");
                                        console.log(paperGSMinput.value); */

                    value = parseFloat(paperGSMinput.value);
                }

                if (value >= 1) {
                    textBlock1.paperGSM = value;
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${value} is not a valid value. Please try again.`);
                    paperGSMinput.value = null;
                }

            })



            /*
            * take in text file from user. 
            */
            const filePicker = document.getElementById('filePicker');
            filePicker.addEventListener('change', handleFiles, false);
            /*
            * File Display for user
            */
            const fileDisplay = document.getElementById('fileList');


            const loadFilesBtn = document.getElementById('load');
            loadFilesBtn.addEventListener('click', event => {
                while (fileDisplay.firstChild) {
                    fileDisplay.removeChild(fileDisplay.firstChild);
                }

                showFilesFromLocal(fileDisplay, textBlock1);
                textMeasure(noShowDiv, textBlock1);
                updateResults();


                let checkElement = document.querySelectorAll("input.activeCheck");
                checkElement.forEach((item) => {
                    item.addEventListener('onload', () => {
                        /*                         console.log("Loaded !!**!!**!!"); */
                    })

                    item.addEventListener('change', () => {
                        /*                         console.log("changed********************"); */

                        let fileKey = item.id;
                        let localText = localStorage.getItem(fileKey);


                        if (item.checked === true) {
                            /*                             console.log("now Checked ************"); */
                            activateFile(textBlock1, fileKey, localText);
                            addChildTextDiv(noShowDiv, textBlock1, fileKey);
                            textMeasure(noShowDiv, textBlock1);
                            updateResults();
                        } else {
                            /*                             console.log("now NOT Checked ************");
                                                        console.log(textBlock1.targetTexts); */
                            textBlock1.targetTexts.delete(`${fileKey}`);
                            removeChildTextDiv(noShowDiv, textBlock1, fileKey);
                            /*                             console.log(textBlock1.targetTexts); */
                            textMeasure(noShowDiv, textBlock1);
                            updateResults();
                        }
                    })
                })
            })

            //TEST NEW FILE Handler
            function handleFiles() {
                handleFilesIn(filePicker);
            }


            /*
            * get section count from user. WITH TEXTBLOCK
            */
            const sectionCountIn = document.getElementById("numSections");
            document.querySelector('#numSections').addEventListener("change", event => {
                let value;
                if (sectionCountIn.value === "") {
                    value = 1;
                } else {

                    //TEST
                    /*                     console.log("NUM SECTIONS __");
                                        console.log(sectionCountIn.value); */

                    value = parseInt(sectionCountIn.value);
                }

                if (value >= 1) {
                    textBlock1.numSections = value;
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${value} is not a valid value. Please try again.`);
                    sectionCountIn.value = null;
                }

            })

            /*
            * get top and bottom margin size from user in px. WITH TEXTBLOCK
            */
            const topBottomMarginIn = document.getElementById("topBotomInput");
            document.querySelector('#topBotomInput').addEventListener("change", event => {
                let value;
                if (topBottomMarginIn.value === "") {
                    value = 0;
                } else {

                    //TEST
                    /*                     console.log("TBM in__");
                                        console.log(topBottomMarginIn.value); */

                    value = parseFloat(topBottomMarginIn.value);
                }

                let inMargin = value
                let inMarginPX = linearConverter(inMargin, textBlock1.linearUnit, "px");
                if (inMarginPX < (textBlock1.pageHeight / 2) && inMarginPX >= 0) {
                    textBlock1.topBottomMargin = inMarginPX;
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${inMargin} is not a valid margin value for a page of this size. Please try again.`);
                    topBottomMarginIn.value = null;
                }

            })

            /*
            * get inside margin size from user in px. WITH TEXTBLOCK
            */
            const insideMarginIn = document.getElementById("insideInput");
            document.querySelector('#insideInput').addEventListener("change", event => {
                let value;
                if (insideMarginIn.value === "") {
                    value = 0;
                } else {

                    //TEST
                    /*                     console.log("IM in__");
                                        console.log(insideMarginIn.value); */

                    value = parseFloat(insideMarginIn.value);
                }


                let inMargin = value;
                let inMarginPX = linearConverter(inMargin, textBlock1.linearUnit, "px");
                if (inMarginPX < (textBlock1.pageWidth - textBlock1.outsideMargin) && inMarginPX >= 0) {
                    textBlock1.insideMargin = inMarginPX;
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${inMargin} is not a valid margin value for a page of this size. Please check the outside margin value and try again.`);
                    insideMarginIn.value = null;
                }

            })

            /*
            * get outside margin size from user in px. WITH TEXTBLOCK
            */
            const ousideMarginIn = document.getElementById("outsideInput");
            document.querySelector('#outsideInput').addEventListener("change", event => {
                let value;
                if (ousideMarginIn.value === "") {
                    value = 0;
                } else {

                    //TEST
                    /*                     console.log("OM in__");
                                        console.log(ousideMarginIn.value); */

                    value = parseFloat(ousideMarginIn.value);
                }

                let inMargin = value;
                let inMarginPX = linearConverter(inMargin, textBlock1.linearUnit, "px");
                if (inMarginPX < (textBlock1.pageWidth - textBlock1.insideMargin) && inMarginPX >= 0) {
                    textBlock1.outsideMargin = inMarginPX;
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${inMargin} is not a valid margin value for a page of this size. Please check the inside margin value and try again.`);
                    ousideMarginIn.value = null;
                }

            })


            /*
            * get font size  from user in points. WITH TEXTBLOCK
            */
            const fontSizeIn = document.getElementById("pointSizeFont");
            document.querySelector('#pointSizeFont').addEventListener("change", event => {

                if (fontSizeIn.value > 0) {
                    textBlock1.targetFontPt = parseFloat(fontSizeIn.value);
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${fontSizeIn.value} is not a valid value. Please try again.`);
                    fontSizeIn.value = null;
                }

            })

            /*
            * get font family from user . WITH TEXTBLOCK
            */
            const fontPicker = document.getElementById("fontList");
            document.querySelector('#fontList').addEventListener("change", event => {
                addFontLink(fontPicker.value);
                //TEST
                /*                 console.log("added header link");
                 */

                textBlock1.fontFamily = fontPicker.value;
                textMeasure(noShowDiv, textBlock1);
                updateResults();
            })

            /*
            * Add download link for font to header
            */
            const headerElement = document.getElementsByTagName('head');
            function addFontLink(fontFamily) {
                const url = "https://fonts.googleapis.com/css?family=" + fontFamily;
                const link = document.createElement('link');
                link.href = url;
                link.rel = "stylesheet";
                headerElement[0].appendChild(link);

            }


            /*
            * get font list and populate fontList selector 
            */
            getFontList().then(results => {
                let html = `<option value='-1'>Select your font</option>`;
                if (results) {
                    results.forEach(font => {
                        html += `<option value='${font.family}'>${font.family}</option>`;
                    });
                    document.querySelector("#fontList").innerHTML = html;
                }
            })

            /*
            * get line spacing  from user. WITH TEXTBLOCK
            */
            const lineSpaceIn = document.getElementById("lineSpacing");
            document.querySelector('#lineSpacing').addEventListener("change", event => {
                let value;
                if (lineSpaceIn.value === "") {
                    value = 1;
                } else {

                    //TEST
                    /*                     console.log("LINE SPACE__");
                                        console.log(lineSpaceIn.value); */

                    value = parseFloat(lineSpaceIn.value);
                }
                if (value > 0) {
                    textBlock1.lineSpacing = value;
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${value} is not a valid value. Please try again.`);
                    lineSpaceIn.value = null;
                }


            })

            /*
            * get paragraph spacing  from user. WITH TEXTBLOCK
            */
            const paragraphSpaceIn = document.getElementById("paragraphSpacing");
            document.querySelector('#paragraphSpacing').addEventListener("change", event => {
                let value;
                if (paragraphSpaceIn.value === "") {
                    value = 1;
                } else {

                    //TEST
                    /*                     console.log("PARA SPACE__");
                                        console.log(paragraphSpaceIn.value); */

                    value = parseFloat(paragraphSpaceIn.value);
                }
                if (value >= 0) {
                    textBlock1.paragraphSpacing = value;
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${value} is not a valid value. Please try again.`);
                    paragraphSpaceIn.value = null;
                }

            })

            /*
            * get number of fly leaves  from user. WITH TEXTBLOCK
            */
            const flyLeavesIn = document.getElementById("numFlyLeaves");
            document.querySelector('#numFlyLeaves').addEventListener("change", event => {
                let value;
                if (flyLeavesIn.value === "") {
                    value = 0;
                } else {

                    //TEST
                    /*                     console.log("FLY LEAVS__");
                                        console.log(flyLeavesIn.value); */

                    value = parseFloat(flyLeavesIn.value);
                }
                if (value >= 0) {
                    textBlock1.flyLeaves = value;
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${value} is not a valid value. Please try again.`);
                    flyLeavesIn.value = null;
                }

            })

            /*
            * get if Title page  from user. WITH TEXTBLOCK
            */
            const titlePageIn = document.getElementById("titlePageAdd");
            document.querySelector('#titlePageAdd').addEventListener("change", event => {
                if (titlePageIn.checked) {
                    //TEST
                    /*                     console.log("checked!!!"); */

                    textBlock1.titlePage = 2;

                } else {
                    //TEST
                    /*                     console.log("Not Checked!!!"); */

                    textBlock1.titlePage = 0;
                }
                textMeasure(noShowDiv, textBlock1);
                updateResults();

            })

            /*
            * get if Table of contents page  from user. WITH TEXTBLOCK
            */
            const tocPageIn = document.getElementById("tocPageAdd");
            document.querySelector('#tocPageAdd').addEventListener("change", event => {
                if (tocPageIn.checked) {
                    //TEST
                    /*              console.log("checked!!!"); */

                    textBlock1.tableOfContentsPage = 2;

                } else {
                    //TEST
                    console.log("Not Checked!!!");

                    textBlock1.tableOfContentsPage = 0;
                }
                textMeasure(noShowDiv, textBlock1);
                updateResults();
            })


            /*
            * get if Copyright page  from user. WITH TEXTBLOCK
            */
            const infoPageIn = document.getElementById("bookInfoPageAdd");
            document.querySelector('#bookInfoPageAdd').addEventListener("change", event => {
                if (infoPageIn.checked) {
                    //TEST
                    /*          console.log("checked!!!"); */

                    textBlock1.infoPage = 2;

                } else {
                    //TEST
                    /*               console.log("Not Checked!!!"); */

                    textBlock1.infoPage = 0;
                }
                textMeasure(noShowDiv, textBlock1);
                updateResults();
            })


            /*
            * get portion of a page taken by each section heading  from user. WITH TEXTBLOCK
            */
            const secionHeaderPortionIn = document.getElementById("chHeadPage");
            document.querySelector('#chHeadPage').addEventListener("change", event => {
                let value;
                if (secionHeaderPortionIn.value === "") {
                    value = 0;
                } else {

                    //TEST
                    /*                     console.log("Ch Header Pg__");
                                        console.log(secionHeaderPortionIn.value); */

                    value = parseFloat(secionHeaderPortionIn.value);
                }
                if (value >= 0) {
                    textBlock1.pagePerSectionHead = value;
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${value} is not a valid value. Please try agian.`);
                    secionHeaderPortionIn.value = null;
                }

            })

            /*
            * get number of a pages taken by images  from user. WITH TEXTBLOCK
            */
            const imgPagesIn = document.getElementById("imagePage");
            document.querySelector('#imagePage').addEventListener("change", event => {
                let value;
                if (imgPagesIn.value === "") {
                    value = 0;
                } else {

                    //TEST
                    /*                     console.log("Image Pg__");
                                        console.log(imgPagesIn.value); */

                    value = parseFloat(imgPagesIn.value);
                }
                if (value >= 0) {
                    textBlock1.imagePages = value;
                    textMeasure(noShowDiv, textBlock1);
                    updateResults();
                } else {
                    alert(`${value} is not a valid value. Please try agian.`);
                    imgPagesIn.value = null;
                }

            })

        });


    </script>
</head>



<body>

    <div class="flex-container">
        <div class="pageHeader flex-container" id="pageHeader" style="background-color: lightcoral;">

            <div class="flex-item">
                <div id="divHeaderImg" class="flex-item">
                    <img id="headerImg" src="images/books.png" alt="books of various sizes standing against eachother">
                </div>
                <div id="divHeaderText" class="flex-item">
                    <h1>TextBlock Planner</h1>
                </div>
            </div>

        </div>

        <div id="resultsDisplay">
            <h6 id="resultsHeader" style="background-color: brown;">Textblock Results</h6>

            <div class="flex-container-inner resultsContent" style="background-color:cornflowerblue;">

                <div class="flex-item-card" style="background-color: aliceblue;">
                    <h5 class="card-header">Pages</h5>
                    <div id="resultNumPages" style="background-color: deeppink;">&nbsp;</div>
                </div>

                <div class="flex-item-card" style="background-color: aliceblue;">
                    <h5 class="card-header">Sheets</h5>
                    <div id="resultNumSheets" style="background-color: deeppink;">&nbsp;</div>
                </div>

                <div class="flex-item-card" style="background-color: aliceblue;">
                    <h5 class="card-header">Thickness</h5>
                    <div id="resultBlockThickness" style="background-color: deeppink;">&nbsp;</div>
                </div>

                <div class="flex-item-card" style="background-color: aliceblue;">
                    <h5 class="card-header">Weight</h5>
                    <div id="resultWeight" style="background-color: deeppink;">&nbsp;</div>
                </div>

                <div class="flex-item-card" style="background-color: aliceblue;">
                    <h5 class="card-header">Settings</h5>
                    <button id="defaultBtn"
                        style="background-color: deeppink; font-size: 14pt; font-weight: bold;">Clear</button>
                </div>


            </div>
        </div>

        <div class="flex-container" id="pageContent">
            <div class="tabBar">

                <div class="section">
                    <h3 data-tab-target="#settings"><img id="settingsImg" src="images/icon-config-small.png" alt="settings cog with ruler icon"> Units</h3>

                    <div class="tab" id="settings" data-tab-content style="background-color: plum;">
                        <div>
                            
                            <fieldset>

                                <legend>Select a Linear Unit:</legend>

                                <div>
                                    <input type="radio" id="pageInCM" name="pageLinearUnit" value="cm">
                                    <label for="pageInCM">cm</label>
                                </div>
                                <div>
                                    <input type="radio" id="pageInIN" name="pageLinearUnit" value="in">
                                    <label for="pageInIN">in</label>
                                </div>
                                <div>
                                    <input type="radio" id="pageInPX" name="pageLinearUnit" value="px">
                                    <label for="pageInPX">pixels</label>
                                </div>

                            </fieldset>

                            <fieldset>

                                <legend>Select a Weight Unit:</legend>

                                <div>
                                    <input type="radio" id="blockInKG" name="pageWeightUnit" value="kg">
                                    <label for="blockInKG">kg</label>
                                </div>
                                <div>
                                    <input type="radio" id="blockInLB" name="pageWeightUnit" value="lb">
                                    <label for="blockInLB">lb</label>
                                </div>

                            </fieldset>
                        </div>

                    </div>
                </div>

                <div class="section">
                    <h3 data-tab-target="#paper"><img id="paperImg" src="images/icon-paper-small.png" alt="paper icon"> Paper Information</h3>

                    <div class="tabContent">
                        <div class="tab" id="paper" data-tab-content style="background-color: aqua;">
                            <div>
                                <h5>Page Dimentions</h5>

                                <div>
                                    <label for="widthInput">Page Width</label>
                                    <input type="number" id="widthInput" name="widthInput" required>
                                </div>

                                <div>
                                    <label for="heightInput">Page Height</label>
                                    <input type="number" id="heightInput" name="heightInput" required>
                                </div>

                            </div>

                            <div>
                                <h5>Paper Weight</h5>
                                <div>
                                    <input type="number" id="paperWeight" name="paperWeight">
                                    <label for="paperWeight">gsm</label>
                                </div>
                            </div>


                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3 data-tab-target="#text"><img id="textImg" src="images/icon-document-small.png" alt="text document icon"> Text Information</h3>

                    <div class="tabContent">
                        <div class="tab" id="text" data-tab-content style="background-color:aquamarine;">
                            <div>
                                <h5>Select Text</h5>
                                <div id="fileList"></div>
                            </div>

                            <div>
                                <h5>Input New TXT File</h5>
                                <label for="filePicker">Select txt Files</label>
                                <input type="file" id="filePicker" name="filePicker" multiple accept=".txt">
                                <button id="load">Load Files</button>

                            </div>

                            <div>
                                <h5>Number of chapters or sections</h5>
                                <div>
                                    <label for="numSections">Chapter/Section Count</label>
                                    <input type="number" id="numSections" name="numSections">

                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3 data-tab-target="#formatting"><img id="formattingImg" src="images/icon-formating-small.png" alt="formatting icon with paragraph symble"> Text Formatting</h3>

                    <div class="tabContent">
                        <div class="tab" id="formatting" data-tab-content style="background-color:bisque;">
                            <div>
                                <div>
                                    <h4>Page Margins</h4>
                                    <div>
                                        <label for="topBotomInput">Top and Bottom Margins</label>
                                        <input type="number" id="topBotomInput" name="topBotomInput" required>
                                    </div>

                                    <div>
                                        <label for="insideInput">Inside Margins</label>
                                        <input type="number" id="insideInput" name="insideInput" required>
                                    </div>

                                    <div>
                                        <label for="outsideInput">Outside Margins</label>
                                        <input type="number" id="outsideInput" name="outsideInput" required>
                                    </div>
                                </div>
                                <div>
                                    <h4>Font Formating</h4>
                                    <div>
                                        <h5>Font point size of body text</h5>
                                        <label for="pointSizeFont">Pt: </label>
                                        <input type="number" id="pointSizeFont" name="pointSizeFont" required>
                                    </div>

                                    <div>
                                        <h5>Font</h5>
                                        <label for="fontList">Select: </label>
                                        <select id="fontList"></select>
                                    </div>
                                </div>



                                <div>
                                    <h4>Paragraph formating</h4>

                                    <div>
                                        <h5>Line Spacing</h5>
                                        <label for="lineSpacing">Spacing: </label>
                                        <input type="number" id="lineSpacing" name="lineSpacing" required>
                                    </div>

                                    <div>
                                        <h5>Line Spacing Between Paragraphs</h5>
                                        <label for="paragraphSpacing">Spacing: </label>
                                        <input type="number" id="paragraphSpacing" name="paragraphSpacing" required>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>


                <div class="section">
                    <h3 data-tab-target="#extras"><img id="extrasImg" src="images/icon-library-small.png" alt="additions icon"> Extras</h3>

                    <div class="tabContent">
                        <div class="tab" id="extras" data-tab-content style="background-color:violet;">

                            <div>
                                <h5>Fly Leaves</h5>
                                <label for="numFlyLeaves">Number of fly leaves, front and back: </label>
                                <input type="number" id="numFlyLeaves" name="numFlyLeaves" required min="0">
                            </div>

                            <div>
                                <h5>Title Page</h5>
                                <label for="titlePageAdd">Add </label>
                                <input type="checkbox" id="titlePageAdd" name="titlePageAdd">
                            </div>

                            <div>
                                <h5>Table of Contents</h5>
                                <label for="tocPageAdd">Add </label>
                                <input type="checkbox" id="tocPageAdd" name="tocPageAdd">
                            </div>

                            <div>
                                <h5>Book Information or Copyright</h5>
                                <label for="bookInfoPageAdd">Add </label>
                                <input type="checkbox" id="bookInfoPageAdd" name="bookInfoPageAdd">
                            </div>

                            <div>
                                <h5>Chapter heading</h5>
                                <label for="chHeadPage">Portion of Page Taken: </label>
                                <input type="number" id="chHeadPage" name="chHeadPage">
                            </div>

                            <div>
                                <h5>Images</h5>
                                <label for="imagePage">Pages taken up by images: </label>
                                <input type="number" id="imagePage" name="imagePage">
                            </div>


                        </div>
                    </div>
                </div>

            </div>


        </div>
    </div>

    <div id="textNoShow" style="display: none;">!</div>

</body>

</html>